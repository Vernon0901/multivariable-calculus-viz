<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizing Functions of Two Variables</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Merriweather:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- MathJax for LaTeX rendering -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="app-container">
        <!-- Sidebar Controls -->
        <aside class="sidebar" id="sidebar">
            <header>
                <h1>Multivariable Calculus</h1>
                <h2>Visualizing \(f(x,y)\)</h2>
            </header>

            <div class="control-group">
                <label for="function-input">Function \(f(x, y)\)</label>
                <div class="input-wrapper">
                    <input type="text" id="function-input" value="x^2 + y^2">
                    <div id="input-error" class="error-msg"
                        style="display:none; color:#ef4444; font-size:0.75rem; margin-top:0.25rem;"></div>
                </div>
                <!-- Tabbed Math Keyboard -->
                <div class="keyboard-container">
                    <div class="keyboard-tabs">
                        <button class="tab-btn active" data-tab="tab-123">123</button>
                        <button class="tab-btn" data-tab="tab-funcs">Funcs</button>
                    </div>

                    <div class="keyboard-content">
                        <!-- Tab 123 (Main) -->
                        <div id="tab-123" class="tab-pane active">
                            <div class="keys-grid-main">
                                <button class="key-btn var-btn" data-key="x">x</button>
                                <button class="key-btn var-btn" data-key="y">y</button>
                                <button class="key-btn op-btn" data-key="^">\(a^b\)</button>
                                <button class="key-btn op-btn" data-key="/">\(\div\)</button>

                                <button class="key-btn num-btn" data-key="7">7</button>
                                <button class="key-btn num-btn" data-key="8">8</button>
                                <button class="key-btn num-btn" data-key="9">9</button>
                                <button class="key-btn op-btn" data-key="*">\(\times\)</button>

                                <button class="key-btn num-btn" data-key="4">4</button>
                                <button class="key-btn num-btn" data-key="5">5</button>
                                <button class="key-btn num-btn" data-key="6">6</button>
                                <button class="key-btn op-btn" data-key="-">-</button>

                                <button class="key-btn num-btn" data-key="1">1</button>
                                <button class="key-btn num-btn" data-key="2">2</button>
                                <button class="key-btn num-btn" data-key="3">3</button>
                                <button class="key-btn op-btn" data-key="+">+</button>

                                <button class="key-btn num-btn" data-key="0">0</button>
                                <button class="key-btn num-btn" data-key=".">.</button>
                                <button class="key-btn action-btn" id="backspace-btn">âŒ«</button>
                                <button class="key-btn action-btn" id="clear-btn">AC</button>
                            </div>
                        </div>

                        <!-- Tab Funcs (Advanced) -->
                        <div id="tab-funcs" class="tab-pane">
                            <div class="keys-grid-funcs">
                                <button class="key-btn func-btn" data-key="sin(">sin</button>
                                <button class="key-btn func-btn" data-key="cos(">cos</button>
                                <button class="key-btn func-btn" data-key="tan(">tan</button>
                                <button class="key-btn func-btn" data-key="exp(">exp</button>

                                <button class="key-btn func-btn" data-key="sqrt(">\(\sqrt{}\)</button>
                                <button class="key-btn func-btn" data-key="log(">log</button>
                                <button class="key-btn func-btn" data-key="ln(">ln</button>
                                <button class="key-btn func-btn" data-key="abs(">|a|</button>

                                <button class="key-btn const-btn" data-key="pi">\(\pi\)</button>
                                <button class="key-btn const-btn" data-key="e">\(e\)</button>
                                <button class="key-btn" data-key="(">(</button>
                                <button class="key-btn" data-key=")">)</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="presets">
                    <!-- 2 Simple Functions -->
                    <button class="preset-btn" data-func="(3*x - 4*y) / sqrt(9 - x^2 - y^2)">\(\frac{3x - 4y}{\sqrt{9 -
                        x^2 - y^2}}\)</button>
                    <button class="preset-btn" data-func="x^2 + y^2">\(x^2 + y^2\)</button>
                    <!-- 2 Complex Functions -->
                    <button class="preset-btn" data-func="sqrt(25 - x^2 - y^2)">\(\sqrt{25 - x^2 - y^2}\)</button>
                    <button class="preset-btn" data-func="sin(x)*cos(y)">\(\sin(x)\cos(y)\)</button>
                </div>
            </div>

            <div class="control-group">
                <label>Input Variables</label>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>\(x\)</span>
                        <span id="x-val-display" class="val-display">0.00</span>
                    </div>
                    <input type="range" id="x-slider" min="-2" max="2" step="0.1" value="0.5">
                </div>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>\(y\)</span>
                        <span id="y-val-display" class="val-display">0.00</span>
                    </div>
                    <input type="range" id="y-slider" min="-2" max="2" step="0.1" value="0.5">
                </div>
            </div>

            <div class="control-group">
                <label>Visualizations</label>
                <div class="toggle-container">
                    <label class="toggle">
                        <span class="label-text">Cross-sections</span>
                        <input type="checkbox" id="toggle-cross-sections">
                        <span class="slider"></span>
                    </label>
                    <label class="toggle">
                        <span class="label-text">Partial Derivatives</span>
                        <input type="checkbox" id="toggle-partials">
                        <span class="slider"></span>
                    </label>
                    <label class="toggle">
                        <span class="label-text">Gradient Vector</span>
                        <input type="checkbox" id="toggle-gradient">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </aside>

        <!-- Main Graph Area -->
        <main class="main-content">
            <div id="plot-container"></div>

            <!-- Consolidated Bottom UI Panels -->
            <div class="bottom-panels-wrapper">
                <!-- Mathematical Analysis Panel (Bottom-Left) -->
                <div id="math-analysis-panel" class="floating-bar math-boxed collapsed">
                    <div class="bar-header" id="math-bar-header">
                        <h3>Mathematical Analysis (Worked)</h3>
                        <button class="collapse-btn" title="Toggle Math View">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div id="math-content-wrapper" class="expanded">
                        <div id="explanation-content" class="math-grid-content">
                            Loading Mathematical Analysis...
                        </div>
                    </div>
                </div>

                <!-- Real World Context Bar (Bottom-Right) -->
                <div id="real-world-context-bar" class="floating-bar math-boxed collapsed">
                    <div class="bar-header" id="bar-header">
                        <h3>Real World Context (AI)</h3>
                        <button class="collapse-btn" title="Toggle AI View">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div id="ai-content-wrapper" class="expanded">
                        <div id="ai-content">
                            Initializing AI...
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Libraries -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.2.0/math.js"></script>
    <script src="script.js"></script>
</body>

</html>